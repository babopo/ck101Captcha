function [y1] = myNNet(x1)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 13-Mar-2017 22:46:00.
%
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = 16xQ matrix, input #1
% and returns:
%   y = 5xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0;0;0;0;0;0;0;0;0;0;0;0;14;0;0;0];
x1_step1.gain = [0.0408163265306122;0.0408163265306122;0.0408163265306122;0.0408163265306122;0.0434782608695652;0.0408163265306122;0.0476190476190476;0.0425531914893617;0.0408163265306122;0.0408163265306122;0.0408163265306122;0.0408163265306122;0.0571428571428571;0.0408163265306122;0.0408163265306122;0.0408163265306122];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.8468856519791068;1.7251921149889258;-1.9679168142265997;-0.08621129403729702;1.416326520520532;1.045677203612617;-0.50583304276565777;-1.5001508148399396;-1.7051459353131178;0.30338717585626268;0.25976774067106739;0.70257382177030236;-0.78138557613409854;-2.360533753540107;-1.4024058147840459;2.0830419983305792;1.5050549746606494;-3.5058547662335462;-1.5657654444768265;-2.5118752346557156;1.1386445705013166];
IW1_1 = [-0.484615120517356 -1.2616648669829018 0.10855048324171768 -0.53152890902225658 0.43070985809389561 -0.43644872039811144 -1.41937035362276 0.069407226546569292 0.8164835722253112 -0.92807263599479617 -0.15734524710288966 0.0088567510248382733 -0.53360545120425251 0.095964636085438884 -0.10857488725206506 1.1194681710173313;0.94202975329919414 -0.012789845767282003 0.35357184351030962 -1.0585929954745994 0.37591178936684427 0.50961185467774728 0.55963786381826963 -1.0021293734340526 -0.40782143049710384 0.37476559970873263 -0.41199354826581991 1.2347430694668409 0.14097054877862586 0.6970119604948406 0.89097147422813983 -0.021738310018510804;0.36729977260013014 -0.81186038623188872 -0.32208142681858581 1.5618005857232868 0.6569390822877742 -0.067035791127920782 0.21174209475604028 -0.25205801969574509 -1.0110009543112315 0.18121544265166561 0.59424973775950785 -2.256050802125785 0.71939826168842391 0.40637157326801437 -0.42853269885218043 0.13351526338332831;1.4806110358444418 1.0180662118540953 -0.47301431243030051 0.56259382330593177 0.35182878672894663 0.10666457728458387 0.66574708227045787 0.28857122021784437 1.3934922232489 -0.44699114776806625 -0.65116319267647615 -0.11561776672164643 0.21934261004982097 -0.17054849430974744 0.63789438979345647 1.430008522525688;1.349820023923046 -0.20842881103551472 0.023108669250047356 -1.6188141653595971 -0.088153004610954502 -0.51364444594069769 -1.4550877949441181 -1.0145050011519436 -0.21621813906665266 -0.22765514205916448 0.24299374589515738 0.085885834917691126 -0.68098637215203484 2.0158734453737579 -0.99894283230390801 0.87974814280521274;0.11853095248202677 0.31049096129302345 -2.3884523526558157 -1.7420261533085628 -0.32660258733699415 -1.1103044913065705 -0.18636192288983372 1.1864706918162102 -1.8918870152937204 -0.31140525551708492 0.47737205732540117 1.0970359957086087 -0.35737416377625941 1.5118697040714992 0.36022310831977067 0.19730561961812917;0.35653159948021068 -0.43807018308417678 0.18202053968410958 -0.25781724324409505 1.4028358007238189 0.33835064903040246 -1.3117463704531398 0.25643255624094946 -0.49979880322400072 2.2914076103765071 -1.1340997465425537 0.14262022389864534 -0.14113805857137698 -1.9880313550016895 2.1005603998842313 -0.15887577748701492;0.39573704965120593 1.4541745667142807 -0.94281065081971205 1.1807496990335531 -0.35683837729258805 -0.11295863210749721 -0.050231003780710944 0.45561308684468121 -0.34635181886042826 1.5191733961035669 1.1456140786483486 1.0645861436078143 0.98650063676988764 1.47680490094939 0.29702548841857529 -0.16003062904429294;2.0041062680030279 -0.32514778544708572 -0.031619491105362128 -0.80838739213704169 -0.27342090087454807 -1.1672521923285033 -0.91377384788327309 1.0159747174824603 -1.9493890707143673 -1.8531061260705475 0.1091399117051597 1.1965514064758866 -0.30151570868628508 0.41278339063525338 -0.23246581697694702 1.7844716577937463;-1.2231138990057691 0.22342765176480406 -0.14901067352031333 1.6306377690750511 -0.41554054730677031 -0.67354851103697932 0.43312453258836431 0.18328316887662388 1.2796430309564193 0.61341070293838051 -1.1522400947541402 0.49210349310726004 -0.35115758989140666 -1.1819660464889148 0.51191296226359895 0.72619278267413778;-1.0886027712734747 -0.064775756073883403 -0.0037876327483032466 0.44641277819244746 -0.27172066229752023 -0.20184329203010173 0.42133955575020798 -0.99900491744110775 1.5978106859264598 -0.80164639978839192 1.512417235554385 -1.4842552165454719 1.2566550759802864 -1.0758847520644019 0.44037483464974597 0.023392430360761076;-0.80372032320414222 -0.52618012249488166 0.51087083748959283 -0.065088163778531702 -1.0679302148940659 -0.36920792443352235 -0.94135301658976167 -1.3892199516789425 -1.2233780391638582 -0.18496590369379462 -0.99658687786051958 -0.86634977670760516 0.46131078339785636 1.4813523297841453 1.5456863792078441 -0.52826500239998542;-1.0210520467245896 -1.6224129110643397 -0.58489693980330382 0.8764272541247754 -0.13113740013154723 -0.054072066525361201 0.12926555462756237 0.068878662690543158 0.69353041552623207 0.12146539260299526 1.1186250015142578 1.14889631945131 -0.64346865667548314 0.45946793612165565 -0.28543033229198772 0.74907266102383641;0.50415450307970888 0.19585003745289428 0.60451069268551139 0.9146329878475209 -1.713458887334083 -0.54518563534958797 0.69154619091815783 1.452088012157704 -0.87743438449698741 -0.012988756581220917 -0.61954679067130336 0.97059855858739086 -0.44918446091621012 -0.29796447891090844 0.77531797761463728 -0.25074152193344118;0.39204298538207877 -0.86250949052644232 0.11092378080256746 -1.0573788755053615 -0.44220192435608957 -0.44866973676256333 -0.87036585355711638 0.085360450423684536 1.2036414079889335 1.2837803416687128 -0.079814233495929782 3.0846700205315076 -1.0770275513944783 -0.30764572106702237 -0.54484695753557133 0.63036053126819591;-0.26914464404862465 -0.31930126325073871 -1.2670434116216762 0.12528447107395496 0.010484649118646739 0.75249825256118963 -0.23210975821235572 0.95432337573956771 -0.012744877987992689 0.71862024384350842 -0.53058324343564378 -0.83738801001636953 0.29462363353692494 -1.788186153724836 1.028178221550839 0.18753882434559555;-1.0289409318789262 0.3652720445353988 -0.63032191523041514 -0.39037899310689034 0.69808499101656918 0.83397905316654342 0.26064608189212751 -1.0673898213772999 -0.082538296299215427 0.16820486537955001 0.69052517960162785 1.0077227991425315 -0.87957183889978952 0.21557810370622352 -0.18525990430557723 0.0740768850853811;0.86223582941500687 0.86283812865485909 2.6264983886322941 0.023835706495603053 1.0495049037313624 -1.174771495712654 -0.26412719034613374 -0.5121831221976747 1.1427379666350928 -0.23639840218915448 0.10037831469951207 0.12204501541365398 0.52597193467984271 0.68866991300395952 -1.6069220751381297 -1.5996182709895053;-0.21789849592891683 -0.78681734336926468 1.4048388797581357 -1.5619697983839782 -0.10442889069707668 1.1943383736661941 0.53710798465018961 0.22324139254633926 1.4580479103494819 0.47632512886968159 -1.7044818608251866 0.5776954572165679 0.68793666149824573 1.5401614816660354 0.35050584160466913 1.0467586609638033;-0.81478637157452538 -0.61086736486980653 0.94534391077706359 0.96893926908742445 -0.2084021421049661 -1.420992976148082 -0.44391053659702195 0.56559659587702449 -0.47267064665877756 -0.092701623846661613 0.77599925718173224 -0.39810009791171347 -0.41780368817800012 0.15147521451872242 2.596064644068329 0.34675533496693517;0.98179054768264462 -0.1969045423929569 -0.68407580867066708 2.1727674328625977 0.52487491454387081 -0.6260897309065101 -0.88673985059848637 0.53312658187992801 0.79713912107981422 -0.70713604435098942 0.81860857574442769 0.078367467253756262 -0.013290171010793371 0.41763099050793306 -0.21309900730143322 -0.24855124455354694];

% Layer 2
b2 = [0.044599730892477311;0.25804690163093935;-2.127589807772956;1.1847140411847636;-0.13312154805319593];
LW2_1 = [0.88298387059630645 0.46782092999113156 1.1819720409615964 -0.79292593008284495 1.5026181185341634 1.38743383121399 1.9728685884962016 1.0247135260653828 -1.1326460787103194 -1.1989085887110709 -2.0532225240739121 0.59241112719499445 -1.1374398209534531 -0.79146346443983928 1.6132840268428634 -1.0422919192638669 -1.255254473574319 0.30812631992746148 -0.63904008459052031 -1.0559027851216967 -0.59175072027644571;-1.4517023640458826 -0.79077835235592253 -1.8538720644209721 -3.2399634931371106 -1.4363722018285887 -1.9605248240357924 0.3080055918620343 -0.021510398115701049 2.1094459850449852 0.93031920105589394 0.57631517612705396 -0.5231843838158976 -0.32026762482392007 -1.6692151247561111 -2.8904838782879048 -0.82760198618083625 -0.45476448798485569 0.34905564855407162 0.48778102360585768 1.8824244597192461 -0.31088707687978195;1.1068662680349293 -0.072327046213511437 -1.2863240249372818 0.10719413346274104 -0.63845266678759272 0.10643990710747221 1.6835887998488446 -0.12490805944952191 -0.89673111112847581 -0.20823825877292987 0.35175714858576745 1.2070198903833516 -0.47394661953111528 1.6362498013635935 -0.49879598335248848 0.59337160324720994 0.86161118977653972 -3.1132412329055144 -0.5233253367766828 0.27769808917861089 1.1649323356439221;1.3444141069448883 0.81939226020394773 0.58797149851218811 1.885397932896747 -1.277683082381738 2.2322781097415532 -1.5072413624516225 0.72602303751086428 -1.2797152433949293 1.2166375772127211 -0.53586575758019517 1.3366080201332424 1.2184371651279853 0.014527716781104759 0.66702663506888538 2.582062705441114 0.87320409268108246 1.8147467686006371 -1.1314902580542066 1.3827626798884616 -2.3077263104308785;0.038940227854525951 -1.324397818560763 0.65605205153162138 0.021484053121573157 0.97103952297970431 -1.2029678231394851 -1.8458907292027897 -1.6661598712323338 1.1662016861819564 -1.7648539700365828 0.89080091858060007 -0.65348278839059903 0.71856267787038153 0.6511580961865242 -0.29970030735062164 0.70651410213525778 -0.26549766103721156 -0.1486364950579985 1.6373719418120407 -1.7347941837651053 -1.5704343085653614];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);

% Output 1
y1 = a2;
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
